{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>

    <script>
      $(document).ready(function() {
        $('#employes').DataTable({
          responsive: true ,
          language: { url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/fr-FR.json' } ,
          columnDefs: [ { orderable: false, targets: [ -1 ] } ]
        });
      });
    </script>
{% endblock %}

{% block title %}Liste des contrats{% endblock %}
 
{% block body %}

<div class="d-flex justify-content-end position-fixed top-0 start-0 m-3">
{% if employeOuAdministrateur == true %}
        <a href="{{ path('app_liste_des_comptes_clients') }}">
{% else %}
        <a href="{{ path('app_login') }}">
{% endif %}
            <img class="icone-cliquable" src="{{ asset('assets/images/page_precedente.png') }}" alt="Icône non trouvé.">
        </a>
</div>

{% if employeOuAdministrateur == true %}
    <a href="{{ path('app_ajouter_un_contrat' , {id : client.id }) }}" class="btn btn-outline-light btn-sm shadow" data-bs-custom-class="custom-tooltip-ajout shadow" data-bs-toggle="tooltip" data-bs-delay='{ "show": 600, "hide": 100 }' data-bs-placement="bottom" data-bs-title="Ajouter un contrat">
    {# &#x2795; #}<img class="icone-cliquable" src="{{ asset('assets/images/icone_ajouter.png') }}" alt="Icône non trouvé."></img>
    </a>
{% endif %}

{# {% set pile = app.session.get('pile_de_pdf_dans_public', []) %}
<h3>Contenu de la pile PDF :</h3>
<ul>
{% for path in pile %}
        <li>{{ path }}</li>
{% else %}
        <li><em>(pile vide)</em></li>
{% endfor %}
</ul> #}

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-12 col-md-6 col-lg-5 d-flex justify-content-center">
            <div class="card bg-transparent" style="width: 18rem;">
                <div class="card-body d-flex flex-column shadow">
                    <span class="card-title mx-auto mb-3 fs-2 fw-light">{{client.prenom}} {{client.nom}}</span>
                    <span class="card-text"><span class="fw-bold">Fixe :</span> {{client.telephoneFixe}}</span>
                    <span class="card-text"><span class="fw-bold">Mobile :</span> {{client.telephoneMobile}}</span>
                    <span class="card-text mt-2 mb-2">{{client.rueEtNumero}}, {{client.codePostal}} {{client.ville}}</span>
                    <span class="card-text"><span class="fw-bold">Société :</span> {{client.societe}}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="table-desktop" class="d-none d-md-block">
    <table id="employes" class="table table-striped shadow">
        <thead>
            <tr>
                <th>Contrat</th>
                <th>Numéro</th>
                <th>Date Prévue</th>
                <th>Fin Prévue</th>
                {# <th>Etat</th> #}
                <th>Début effectif</th>
                <th>Fin effective</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for c in listeDesContrats %}
                <tr>
                    <td>{{c.intitule}}</td>
                    <td>{{c.numeroContrat}}</td>
                    <td>{{c.dateDebutPrevue ? c.dateDebutPrevue|date('d-m-Y') : ''}}</td>
                    <td>{{c.dateFinPrevue ? c.dateFinPrevue|date('d-m-Y') : ''}}</td>
                    <td>{{c.dateDebut ? c.dateDebut|date('d-m-Y') : ''}}</td>
                    <td>{{c.dateFin ? c.dateFin|date('d-m-Y') : ''}}</td>
                    <td style="vertical-align: middle;">
                        <div class="d-flex justify-content-between align-items-center">
                            {# <a href="{{ path('app_liste_des_contrats' , {id : e.id}) }}" class="btn btn-outline-light btn-sm w-50 me-2">&nbsp;Voir&nbsp;</a>
                            <a href="{{ path('app_editer_un_compte_client' , {id : e.id}) }}" class="btn btn-outline-light btn-sm w-50">Editer</a> #}
                            <a href="{{ path( 'app_voir_un_contrat' , { id : c.id} ) }}" class="btn btn-sm shadow w-50 me-2" data-bs-custom-class="custom-tooltip-edition shadow" data-bs-toggle="tooltip" data-bs-delay='{ "show": 600, "hide": 100 }' data-bs-placement="bottom" data-bs-title="Voir">
                            {# &#x1f50d; #}<img class="icone-cliquable" src="{{ asset('assets/images/icone_loupe.png') }}" alt="Icône non trouvé."></img>
                            </a>
                            {% if employeOuAdministrateur == true %}
                                <a href="{{ path( 'app_editer_un_contrat' , { id : c.id} ) }}" class="btn btn-sm shadow w-50" data-bs-custom-class="custom-tooltip-edition shadow" data-bs-toggle="tooltip" data-bs-delay='{ "show": 600, "hide": 100 }' data-bs-placement="bottom" data-bs-title="Editer">
                                {# &#x1f4dd; #}<img class="icone-cliquable" src="{{ asset('assets/images/icone_edition.png') }}" alt="Icône non trouvé."></img>
                                </a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{# <div id="table-mobile" class="d-block d-md-none">
    {% for e in listeDesEmployes %}
        <div class="d-flex justify-content-start mb-3">
            <div class="w-75">
                <span class="fw-bold fs-3">{{e.prenom}} {{e.nom}}</span><br>
                {% for r in e.roles %}<span class="fs-6 fs-italic">{{r|replace({'ROLE_':''})|replace({'_':' '})|lower|capitalize}}{% if not(loop.last) %} ,<br>{% endif %}</span>{% endfor %}<br>
                {{e.Courriel}}
            </div>
            <div class="d-flex flex-column align-items-center justify-content-center">
                <a href="{{ path('app_voir_un_employe' , {id : e.id}) }}" class="btn btn-outline-light btn-sm w-100 mb-3">Voir</a>
                <a href="" class="btn btn-outline-light btn-sm w-100">Editer</a>
            </div>
        </div>
    {% endfor %}
</div> #}

{% if employeOuAdministrateur == true %}
    <a href="{{ path('app_liste_des_comptes_clients') }}" class="btn btn-outline-light btn-sm shadow mt-4">Retour</a>
{% else %}
    <a href="{{ path('app_login') }}" class="btn btn-outline-light btn-sm shadow mt-4">Retour</a>
{% endif %}

<br><br>

{% endblock %}
